<section>
	<header>
		<span class="brand"><a href="/">ðŸ”¥ sizzle.link</a> : View your secret</span>
	</header>

	<p class="disclosure"><strong>Disclosure:</strong> Viewing will burn the secret. It will never be shown again.</p>

	<p class="error" data-element data-bind:text="error">Error message goes here</p>

	<form method="post">
		<label>
			<span>Password</span>
			<input name="password" type="password" autocomplete="current-password" placeholder="Enter password to decrypt" autofocus />
		</label>

		<div class="actions">
			<button name="do" value="view">View and burn</button>
			<a href="/">Go back</a>
		</div>
	</form>

</section>

<dialog class="output" id="secret" data-element data-bind:data-secret="secret">
	<form>
		<label>
			<span>Secret</span>
			<textarea name="secret" readonly data-bind:value="secret">This secret has sizzled</textarea>
		</label>

		<div class="actions">
			<button class="copy-close">Copy & close</button>
		</div>
	</form>
	<script>
		const dialog = document.currentScript.parentElement;
		const textarea = dialog.querySelector("[name='secret']");
		const button = dialog.querySelector("button.copy-close");
		textarea.select();
		dialog.showModal();
		button.addEventListener("click", e => {
			e.preventDefault();
			navigator.clipboard.writeText(textarea.value);
			dialog.close();
			window.location = "/";
		});
	</script>
</dialog>
